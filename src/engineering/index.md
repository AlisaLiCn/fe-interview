
### npm、yarn与pnpm的区别

**npm V1-V2**
项目的依赖项在node_modules内部，采用嵌套的结构，这种设计存在的问题：
- 依赖嵌套的层级深，会导致文件路径过长的问题，尤其是在windows系统中。
- 大量重复的包被安装，文件体积超级大，
- 模块实例不能共享，无法共享内部变量，可能导致一些不可预知的bug。

**npm V3 & yarn**
采用扁平化依赖的管理方式，解决了重复安装和嵌套层级深的问题。但存在其他问题：
- 依赖树结构的不确定性，例如两个不同的依赖项，又分别依赖同一个依赖的不同版本，那么被提升的版本是哪个取决于这两个依赖在package.json中声明的顺序。
- 扁平化算法本身复杂度高，耗时较长。
- 项目中可以非法访问没有声明过的依赖包。

**pnpm**
- 节省空间：使用基于内容寻址的文件系统来存储磁盘上的文件，在全局store里存储依赖，真正使用时通过硬链接来引用。
- 安装速度快
- 支持monorepo
- 安全性高：子依赖不会被提升，不会产生幽灵依赖。

> 内容寻址：通过文件内容生成内容地址（通常是通过hash算法生成），再通过内容地址找到文件。

参考资料：
- [关于现代包管理器的深度思考——为什么现在我更推荐 pnpm 而不是 npm/yarn?](https://juejin.cn/post/6932046455733485575)


